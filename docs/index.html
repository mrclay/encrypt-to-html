<!doctypehtml><html lang=en><script data-el=store type=encrypted>null</script><meta charset=utf-8><title>Encrypt to HTML</title><link crossorigin=anonymous href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css integrity=sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7 rel=stylesheet><style>textarea{font-family:monospace;white-space:pre-wrap;width:90%;height:10em}[hidden]{display:none!important}body{margin:2em 0}header{margin:0 2em 2em}section{margin:0 2em}footer{margin-top:2em;padding:1em 2em 0;border-top:1px solid #ccc}textarea{font-family:monospace}input[data-el=file]{display:inline-block}#file_base{width:10em;display:inline-block;vertical-align:middle}[for=pwd1] small{font-style:italic}[type=submit] img{height:1em;margin-left:5px}</style></head><body><header><h1 class=text-muted>Encrypt to HTML</h1><p>This outputs a standalone HTML file that can be decrypted <em>anywhere</em>, even offline.</p><p>100% client-side. <a download=encrypt-to-html.html>Download</a> and use it anywhere.</p></header><section data-el=alert hidden><div class="alert alert-success"role=alert><p data-el=alertMsg></p></div></section><section data-el=encrypt hidden><div class=form-group><label for=msg>Sensitive Content</label> ...or <input data-el=file type=file><textarea autofocus class=form-control data-el=in id=msg required rows=5></textarea></div><div class=form-group><label for=pwd1>Password (repeat) <small>Use a strong one!</small></label><input autocomplete=off class=form-control data-el=pwd1 id=pwd1 required type=password><input autocomplete=off class=form-control data-el=pwd2 id=pwd2 required type=password></div><div class=form-group><label for=file_base>Filename </label><input class=form-control data-el=name id=file_base required value=my-secret> .html</div><button class="btn btn-primary"data-el=encryptBtn>Encrypt</button></section><section data-el=decrypt hidden><div data-el=pwdWrapper><div class=form-group><label for=pwd>Password</label><input autocomplete=off class=form-control data-el=pwd id=pwd required type=password></div><p><button class="btn btn-primary"data-el=decryptBtn>Decrypt</button></p></div><div class=form-group data-el=outWrapper><label for=msg_out>Stored Content</label><textarea autofocus class=form-control data-el=out id=msg_out readonly rows=10></textarea></div><div><p><button class="btn btn-primary"data-el=reset>Encrypt something new</button></p></div></section><footer><p>By <a href=http://www.mrclay.org/>Steve Clay</a>. <a href=https://github.com/mrclay/encrypt-to-html>Source</a>. Uses WebCrypto (256-bit AES-GCM, PBKDF2 key generation with at least 500K rounds). Version 2.0.</p><p>Dig it? Send me something on my <a href=https://www.amazon.com/hz/wishlist/ls/2QG3N5JPO53BD?ref_=wl_share>wish list</a>.</p></footer><script>(async()=>{const v=t=>crypto.subtle.importKey("raw",new TextEncoder().encode(t),"PBKDF2",!1,["deriveBits","deriveKey"]);async function E(t,n,o,a,s){const l=await v(t),d=await crypto.subtle.deriveKey({name:"PBKDF2",salt:o,iterations:n,hash:"SHA-256"},l,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return crypto.subtle.decrypt({name:"AES-GCM",iv:a},d,s)}async function b(t,n){const o=crypto.getRandomValues(new Uint8Array(16)),a=crypto.getRandomValues(new Uint8Array(16));let s=await v(t),l=5e6,d;for(let u=0;u<20;u++){const p=performance.now();if(d=await crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:l,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),performance.now()-p>500)break;l=Math.round(l*1.5)}return{encryptedBuffer:await crypto.subtle.encrypt({name:"AES-GCM",iv:o},d,n),iterations:l,salt:a,iv:o}}const m=t=>btoa(new Uint8Array(t).reduce((n,o)=>n+String.fromCharCode(o),"")),w=t=>{const n=atob(t),o=n.length,a=new Uint8Array(o);for(let s=0;s<o;s++)a[s]=n.charCodeAt(s);return a.buffer};function k(t,n){const o=URL.createObjectURL(t),a=document.createElement("a");a.style.display="none",a.href=o,a.download=n,document.body.appendChild(a),a.click(),URL.revokeObjectURL(o)}let r={alertMsg:"",alertType:"success",done:!1,filename:"",input:"",inputHeight:0,mode:"encrypt",output:"",password:"",storedData:null,working:!1},g={...r};function c(t){g={...r};const n=typeof t=="function"?t(r):t;r={...r,...n},M(),B()}function M(){const{mode:t,input:n,output:o,password:a,filename:s}=r;g.filename!==s&&(e.name.value=s),t!==g.mode&&t==="encrypt"&&(r.input=o,e.in.value=o,r.filename="",e.pwd1.value=a,e.pwd2.value=a)}const e={};function B(){const t=["alertMsg","pwd1","pwd2","encryptBtn","file","name","out","pwd","decryptBtn"];r.mode==="encrypt"?(t.push("encrypt"),r.filename||t.push("in"),e.encryptBtn.textContent=r.working?"⏳ Working...":"Encrypt",e.encryptBtn.style.opacity=r.working?".6":""):(t.push("decrypt"),r.done?t.push("outWrapper","reset"):t.push("pwdWrapper"),e.decryptBtn.textContent=r.working?"⏳ Working...":"Decrypt",e.decryptBtn.style.opacity=r.working?".6":""),r.alertMsg&&(e.alertMsg.textContent=r.alertMsg,e.alert.querySelector("div").className=`alert alert-${r.alertType}`,t.push("alert")),document.querySelectorAll("[data-el]").forEach(n=>{n.hidden=!t.includes(n.dataset.el)}),e.out.value=r.output}const i={adjustInputHeight(){e.in.scrollHeight>e.in.offsetHeight+10&&(e.in.style.height=e.in.scrollHeight+10+"px")},setFilename:()=>c({filename:e.file.files[0].name}),onFocusName(){e.name.value==="my-secret"&&e.name.select()},async doEncrypt(){if(r.working)return;if(e.pwd1.value!==e.pwd2.value){c({alertMsg:"Passwords do not match",alertType:"warning"});return}if(e.pwd1.value.length<6){c({alertMsg:"Password less than 6 characters",alertType:"warning"});return}const t=e.pwd1.value,n=e.file.files;c({input:e.in.value,password:t,working:!0});let o=new TextEncoder().encode(e.in.value);n[0]&&(o=await new Promise(a=>{reader=new FileReader,reader.onload=s=>a(s.target.result),reader.readAsArrayBuffer(n[0])})),b(t,o).then(a=>{const{iterations:s,salt:l,iv:d,encryptedBuffer:y}=a,u=[r.filename,s,m(l),m(d),m(y)];e.store.textContent=JSON.stringify(u),document.querySelectorAll("[hidden]").forEach(f=>f.removeAttribute("hidden"));const p=new Blob(["<!DOCTYPE html>",document.querySelector("html").outerHTML],{type:"text/html"});k(p,e.name.value+".html"),c({alertMsg:"Your message/file was encrypted to an HTML file.",alertType:"success",done:!0,working:!1})})},doDecrypt(){if(r.working)return;const[t,n,o,a,s]=r.storedData,l=e.pwd.value;c({password:l,working:!0});const d=w(o),y=w(a),u=w(s);E(e.pwd.value,n,d,y,u).then(p=>{let f="",h="";if(t){const S=new Blob([p]);k(S,t),h="Decrypted file downloaded."}else f=new TextDecoder().decode(p),h="Message decrypted.";c({alertMsg:h,alertType:"success",done:!0,output:f,working:!1})}).catch(p=>{c({alertMsg:String(p),alertType:"danger",working:!1})})},reset(){c({alertMsg:"",done:!1,input:r.output,mode:"encrypt"})}};document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-el]").forEach(n=>{e[n.dataset.el]=n}),setInterval(i.adjustInputHeight,1e3),e.file.addEventListener("change",i.setFilename),e.name.addEventListener("focus",i.onFocusName),e.encryptBtn.addEventListener("click",i.doEncrypt),e.pwd2.addEventListener("keydown",n=>{n.key==="Enter"&&i.doEncrypt()}),e.decryptBtn.addEventListener("click",i.doDecrypt),e.pwd.addEventListener("keydown",n=>{n.key==="Enter"&&i.doDecrypt()}),e.reset.addEventListener("click",i.reset);const t=JSON.parse(e.store.textContent);c({mode:t?"decrypt":"encrypt",storedData:t})})})();</script></body></html>