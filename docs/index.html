<!doctype html><html lang=en><script data-el=store type=encrypted>null</script><meta charset=utf-8><title>Encrypt to HTML</title><link crossorigin=anonymous href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css integrity=sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7 rel=stylesheet><style>textarea{font-family:monospace;white-space:pre-wrap;width:90%;height:10em}[hidden]{display:none!important}body{margin:2em 0}header{margin:0 2em 2em}section{margin:0 2em}footer{margin-top:2em;padding:1em 2em 0;border-top:1px solid #ccc}textarea{font-family:monospace}input[data-el=file]{display:inline-block}#file_base{width:10em;display:inline-block;vertical-align:middle}[for=pwd1] small{font-style:italic}[type=submit] img{height:1em;margin-left:5px}</style></head><body><header><h1 class=text-muted>Encrypt to HTML</h1><p>Encrypt a message/file to a standalone HTML file that can be decrypted offline.</p><p>100% client-side. <a download=encrypt-to-html.html href=./>Download</a> and use it anywhere. (<a href=https://github.com/mrclay/encrypt-to-html/blob/master/index.html rel=noopener target=_blank>Unminified source</a>)</p></header><section data-el=alert hidden><div class="alert alert-success"role=alert><p data-el=alertMsg></p></div></section><section data-el=encrypt hidden><div class=form-group><label for=msg>Sensitive Content</label> ...or <input data-el=file type=file><textarea autofocus class=form-control data-el=in id=msg required rows=5></textarea></div><div class=form-group><label for=pwd1>Password (repeat) <small>Use a strong one!</small></label><input autocomplete=off class=form-control data-el=pwd1 id=pwd1 required type=password><input autocomplete=off class=form-control data-el=pwd2 id=pwd2 required type=password></div><div class=form-group><label for=file_base>Filename </label><input class=form-control data-el=name id=file_base required value=my-secret> .html</div><button class="btn btn-primary"data-el=encryptBtn>Encrypt</button></section><section data-el=decrypt hidden><div data-el=pwdWrapper><div class=form-group><label for=pwd>Password</label><input autocomplete=off class=form-control data-el=pwd id=pwd required type=password></div><p><button class="btn btn-primary"data-el=decryptBtn>Decrypt</button></p></div><div class=form-group data-el=outWrapper><label for=msg_out>Stored Content</label><textarea autofocus class=form-control data-el=out id=msg_out readonly rows=10></textarea></div><div><p><button class="btn btn-primary"data-el=reset>Encrypt something new</button></p></div></section><footer><p>By <a href=http://www.mrclay.org/>Steve Clay</a>. <a href=https://github.com/mrclay/encrypt-to-html>Source</a>. Uses WebCrypto (256-bit AES-GCM, PBKDF2 key generation with at least 500K rounds). Version 2.0.</p><p>Dig it? Send me something on my <a href=https://www.amazon.com/hz/wishlist/ls/2QG3N5JPO53BD?ref_=wl_share>wish list</a>.</p></footer><script>(async()=>{const k=t=>crypto.subtle.importKey("raw",new TextEncoder().encode(t),"PBKDF2",!1,["deriveBits","deriveKey"]);async function b(t,n,a,o,s){const i=await k(t),d=await crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:n,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return crypto.subtle.decrypt({name:"AES-GCM",iv:o},d,s)}async function S(t,n){const a=crypto.getRandomValues(new Uint8Array(16)),o=crypto.getRandomValues(new Uint8Array(16));let s=await k(t),i=5e6,d;for(let u=0;u<20;u++){const p=performance.now();if(d=await crypto.subtle.deriveKey({name:"PBKDF2",salt:o,iterations:i,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),performance.now()-p>500)break;i=Math.round(i*1.5)}return{encryptedBuffer:await crypto.subtle.encrypt({name:"AES-GCM",iv:a},d,n),iterations:i,salt:o,iv:a}}const w=t=>btoa(new Uint8Array(t).reduce((n,a)=>n+String.fromCharCode(a),"")),g=t=>{const n=atob(t),a=n.length,o=new Uint8Array(a);for(let s=0;s<a;s++)o[s]=n.charCodeAt(s);return o.buffer};function M(t,n){const a=URL.createObjectURL(t),o=document.createElement("a");o.style.display="none",o.href=a,o.download=n,document.body.appendChild(o),o.click(),URL.revokeObjectURL(a)}const h="success",y=1,B=2;let r={alertMsg:"",alertType:h,done:!1,filename:"",input:"",inputHeight:0,mode:y,output:"",password:"",storedData:null,working:!1},v={...r};function l(t){v={...r};const n=typeof t=="function"?t(r):t;r={...r,...n},C(),D()}function C(){const{mode:t,input:n,output:a,password:o,filename:s}=r;v.filename!==s&&(e.name.value=s),t!==v.mode&&t===y&&(r.input=a,e.in.value=a,r.filename="",e.pwd1.value=o,e.pwd2.value=o)}const e={};function D(){const t=["alertMsg","pwd1","pwd2","encryptBtn","file","name","out","pwd","decryptBtn"],n="⏳ Working...";r.mode===y?(t.push("encrypt"),r.filename||t.push("in"),e.encryptBtn.textContent=r.working?n:"Encrypt",e.encryptBtn.style.opacity=r.working?".6":""):(t.push("decrypt"),r.done?t.push("outWrapper","reset"):t.push("pwdWrapper"),e.decryptBtn.textContent=r.working?n:"Decrypt",e.decryptBtn.style.opacity=r.working?".6":""),r.alertMsg&&(e.alertMsg.textContent=r.alertMsg,e.alert.querySelector("div").className=`alert alert-${r.alertType}`,t.push("alert")),document.querySelectorAll("[data-el]").forEach(a=>{a.hidden=!t.includes(a.dataset.el)}),e.out.value=r.output}const c={adjustInputHeight(){e.in.scrollHeight>e.in.offsetHeight+10&&(e.in.style.height=e.in.scrollHeight+10+"px")},setFilename:()=>l({filename:e.file.files[0].name}),onFocusName(){e.name.value==="my-secret"&&e.name.select()},async doEncrypt(){if(r.working)return;if(e.pwd1.value!==e.pwd2.value){l({alertMsg:"Passwords do not match",alertType:"warning"});return}if(e.pwd1.value.length<6){l({alertMsg:"Password less than 6 characters",alertType:"warning"});return}const t=e.pwd1.value,n=e.file.files;l({input:e.in.value,password:t,working:!0});let a=new TextEncoder().encode(e.in.value);n[0]&&(a=await new Promise(o=>{reader=new FileReader,reader.onload=s=>o(s.target.result),reader.readAsArrayBuffer(n[0])})),S(t,a).then(o=>{const{iterations:s,salt:i,iv:d,encryptedBuffer:f}=o,u=[r.filename,s,w(i),w(d),w(f)];e.store.textContent=JSON.stringify(u),document.querySelectorAll("[hidden]").forEach(m=>m.removeAttribute("hidden"));const p=new Blob(["<!DOCTYPE html>",document.querySelector("html").outerHTML],{type:"text/html"});M(p,e.name.value+".html"),l({alertMsg:"Your message/file was encrypted to an HTML file.",alertType:h,done:!0,working:!1})})},doDecrypt(){if(r.working)return;const[t,n,a,o,s]=r.storedData,i=e.pwd.value;l({password:i,working:!0});const d=g(a),f=g(o),u=g(s);b(e.pwd.value,n,d,f,u).then(p=>{let m="",E="";if(t){const A=new Blob([p]);M(A,t),E="Decrypted file downloaded."}else m=new TextDecoder().decode(p),E="Message decrypted.";l({alertMsg:E,alertType:h,done:!0,output:m,working:!1})}).catch(p=>{l({alertMsg:String(p),alertType:"danger",working:!1})})},reset(){l({alertMsg:"",done:!1,input:r.output,mode:y})}};document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-el]").forEach(n=>{e[n.dataset.el]=n}),setInterval(c.adjustInputHeight,1e3),e.file.addEventListener("change",c.setFilename),e.name.addEventListener("focus",c.onFocusName),e.encryptBtn.addEventListener("click",c.doEncrypt),e.pwd2.addEventListener("keydown",n=>{n.key==="Enter"&&c.doEncrypt()}),e.decryptBtn.addEventListener("click",c.doDecrypt),e.pwd.addEventListener("keydown",n=>{n.key==="Enter"&&c.doDecrypt()}),e.reset.addEventListener("click",c.reset);const t=JSON.parse(e.store.textContent);l({mode:t?B:y,storedData:t})})})();</script></body></html>